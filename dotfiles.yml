---
# Ensure Dotfiles
- name: Install Stow
  become: true
  package:
    name: stow
  register: stow

- name: Check for and or Download Dotfiles
  git:
    repo: git@github.com:Lars5Janssen/dotfiles.git
    dest: ~/dotfiles/
    update: no

- name: Stow Dotfiles
  when: stow is succeeded
  command:
    chdir: ~/dotfiles/
    cmd: stow . -v
  register: result
  changed_when: result.stdout.find('LINK') != -1
  failed_when: result.rc != 0

  # Cron Job that reminds of Unsaved Changes
