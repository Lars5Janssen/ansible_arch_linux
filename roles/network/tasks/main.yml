#SPDX-License-Identifier: MIT-0
---
# tasks file for network
- name: Install Network Packages
  become: true
  pacman:
    name:
      - dhcpcd
      - network-manager-applet
      - networkmanager
      - networkmanager-openvpn
      - nm-connection-editor

- name: Unwanted NetworkManagers
  become: true
  pacman:
    state: absent
    name:
      - iwd
      - netctl
      - systemd-networkd
      - connman
      - dhcpclient

# - name: dhcpcd
#   become: true
#   blockinfile:
#     create: true
#     path: /etc/NetworkManager/conf.d/dhcpcd.conf
#     block: |
#       [main]
#       dhcp=dhcpcd

- name: Dhcpcd not active
  become: true
  systemd:
    name: dhcpcd.service
    state: stopped
    enabled: no

- name: remove dhcpcd
  become: true
  file:
    state: absent
    path: /etc/NetworkManager/conf.d/dhcpcd.conf

- name: Enable NetworkManager
  become: true
  systemd:
    name: NetworkManager
    state: started
    enabled: yes

# - name: Reload NetworkManager
#   become: true
#   systemd:
#     name: NetworkManager
#     state: reloaded

# TODO
# - name: Eduroam
